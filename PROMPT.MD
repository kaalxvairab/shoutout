# Shoutout ‚Äî Claude Code Implementation Prompt

## Project Overview

Build **Shoutout**, an employee recognition platform where team members send each other "Shoutouts" ‚Äî short messages of appreciation tied to company values, with points attached. Each employee gets 500 points per month to give out. Points received accumulate and can be redeemed for rewards.

## Tech Stack (strict ‚Äî do not deviate)

- **Framework:** Next.js 14+ (App Router)
- **Language:** JavaScript (NOT TypeScript)
- **Styling:** Tailwind CSS + shadcn/ui components
- **Backend/DB/Auth:** Supabase (PostgreSQL, Auth, Realtime)
- **Package manager:** npm

## Project Setup

1. Create a new Next.js project with App Router, JavaScript, Tailwind CSS
2. Install and configure shadcn/ui (use the default theme, slate base colour)
3. Install `@supabase/supabase-js` and `@supabase/ssr`
4. Create a `.env.local` file with placeholders:
   ```
   NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
   NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
   ```
5. Set up Supabase client utilities:
   - `/lib/supabase/client.js` ‚Äî browser client using `createBrowserClient`
   - `/lib/supabase/server.js` ‚Äî server client using `createServerClient` with cookies
   - `/lib/supabase/middleware.js` ‚Äî middleware helper for session refresh

## Database Schema

Create a Supabase SQL migration file at `/supabase/migrations/001_initial_schema.sql` with the following:

```sql
-- Profiles table (extends Supabase auth.users)
CREATE TABLE profiles (
  id UUID PRIMARY KEY REFERENCES auth.users(id) ON DELETE CASCADE,
  full_name TEXT,
  job_title TEXT,
  department TEXT,
  avatar_url TEXT,
  birthday DATE,
  join_date DATE DEFAULT CURRENT_DATE,
  points_balance INTEGER DEFAULT 0,
  points_given_this_month INTEGER DEFAULT 0,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Shoutouts table
CREATE TABLE shoutouts (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  sender_id UUID REFERENCES profiles(id) ON DELETE CASCADE NOT NULL,
  recipient_id UUID REFERENCES profiles(id) ON DELETE CASCADE NOT NULL,
  message TEXT NOT NULL CHECK (char_length(message) BETWEEN 10 AND 280),
  category TEXT NOT NULL CHECK (category IN ('teamwork', 'innovation', 'above_and_beyond', 'customer_focus', 'problem_solving', 'leadership')),
  points INTEGER NOT NULL CHECK (points BETWEEN 10 AND 100),
  created_at TIMESTAMPTZ DEFAULT NOW(),
  CONSTRAINT no_self_shoutout CHECK (sender_id != recipient_id)
);

-- Badges table
CREATE TABLE badges (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name TEXT NOT NULL,
  description TEXT,
  icon TEXT NOT NULL,
  criteria TEXT
);

-- User badges (many-to-many)
CREATE TABLE user_badges (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES profiles(id) ON DELETE CASCADE NOT NULL,
  badge_id UUID REFERENCES badges(id) ON DELETE CASCADE NOT NULL,
  awarded_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(user_id, badge_id)
);

-- Rewards catalogue
CREATE TABLE rewards (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name TEXT NOT NULL,
  description TEXT,
  cost INTEGER NOT NULL,
  icon TEXT,
  active BOOLEAN DEFAULT TRUE
);

-- Reward redemptions
CREATE TABLE reward_redemptions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES profiles(id) ON DELETE CASCADE NOT NULL,
  reward_id UUID REFERENCES rewards(id) ON DELETE CASCADE NOT NULL,
  points_spent INTEGER NOT NULL,
  redeemed_at TIMESTAMPTZ DEFAULT NOW()
);

-- Enable Row Level Security on all tables
ALTER TABLE profiles ENABLE ROW LEVEL SECURITY;
ALTER TABLE shoutouts ENABLE ROW LEVEL SECURITY;
ALTER TABLE badges ENABLE ROW LEVEL SECURITY;
ALTER TABLE user_badges ENABLE ROW LEVEL SECURITY;
ALTER TABLE rewards ENABLE ROW LEVEL SECURITY;
ALTER TABLE reward_redemptions ENABLE ROW LEVEL SECURITY;

-- RLS Policies

-- Profiles: anyone authenticated can read all profiles, users can update their own
CREATE POLICY "Profiles are viewable by authenticated users" ON profiles FOR SELECT TO authenticated USING (true);
CREATE POLICY "Users can update own profile" ON profiles FOR UPDATE TO authenticated USING (auth.uid() = id);
CREATE POLICY "Users can insert own profile" ON profiles FOR INSERT TO authenticated WITH CHECK (auth.uid() = id);

-- Shoutouts: anyone authenticated can read, authenticated users can insert
CREATE POLICY "Shoutouts are viewable by authenticated users" ON shoutouts FOR SELECT TO authenticated USING (true);
CREATE POLICY "Authenticated users can create shoutouts" ON shoutouts FOR INSERT TO authenticated WITH CHECK (auth.uid() = sender_id);

-- Badges: anyone authenticated can read
CREATE POLICY "Badges are viewable by authenticated users" ON badges FOR SELECT TO authenticated USING (true);

-- User badges: anyone authenticated can read
CREATE POLICY "User badges are viewable by authenticated users" ON user_badges FOR SELECT TO authenticated USING (true);

-- Rewards: anyone authenticated can read
CREATE POLICY "Rewards are viewable by authenticated users" ON rewards FOR SELECT TO authenticated USING (true);

-- Reward redemptions: users can see their own, insert their own
CREATE POLICY "Users can view own redemptions" ON reward_redemptions FOR SELECT TO authenticated USING (auth.uid() = user_id);
CREATE POLICY "Users can redeem rewards" ON reward_redemptions FOR INSERT TO authenticated WITH CHECK (auth.uid() = user_id);

-- Function: auto-create profile on signup
CREATE OR REPLACE FUNCTION public.handle_new_user()
RETURNS TRIGGER AS $$
BEGIN
  INSERT INTO public.profiles (id)
  VALUES (NEW.id);
  RETURN NEW;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

CREATE TRIGGER on_auth_user_created
  AFTER INSERT ON auth.users
  FOR EACH ROW EXECUTE FUNCTION public.handle_new_user();

-- Seed: badges
INSERT INTO badges (name, description, icon, criteria) VALUES
  ('First Shoutout Sent', 'Sent your very first Shoutout', 'üåü', 'Send 1 shoutout'),
  ('High Five', 'Sent 5 Shoutouts', 'üñêÔ∏è', 'Send 5 shoutouts'),
  ('Shoutout Star', 'Received 10 Shoutouts', '‚≠ê', 'Receive 10 shoutouts'),
  ('Top Recognised', 'Most recognised employee of the month', 'üèÜ', 'Top points received in a month'),
  ('Team Player', 'Sent 5+ Shoutouts in a single month', 'ü§ù', 'Send 5+ shoutouts in one month'),
  ('Birthday Badge', 'Happy Birthday!', 'üéÇ', 'Auto-awarded on birthday'),
  ('Work Anniversary', 'Celebrating another year!', 'üìÖ', 'Auto-awarded on join date anniversary');

-- Seed: rewards
INSERT INTO rewards (name, description, cost, icon) VALUES
  ('Coffee for the team', 'Treat your team to a round of coffees', 200, '‚òï'),
  ('Breakfast for the team', 'Breakfast is on you!', 500, 'ü•ê'),
  ('¬£10 Amazon Voucher', 'A little something for yourself', 750, 'üéÅ'),
  ('¬£25 Amazon Voucher', 'Treat yourself', 1500, 'üéÅ'),
  ('Half Day Off', 'Take an afternoon off, you earned it', 2000, 'üèñÔ∏è'),
  ('Full Day Off', 'A whole day to recharge', 3500, 'üèñÔ∏è');

-- Seed: demo profiles (these will need matching auth.users ‚Äî for demo, create via Supabase dashboard or seed script)
-- We'll handle demo data seeding separately
```

## Folder Structure

```
/app
  /login
    page.js                  ‚Äî Magic link login page
  /auth
    /callback
      route.js               ‚Äî Supabase auth callback handler
  /onboarding
    page.js                  ‚Äî Profile completion after first login
  /dashboard
    page.js                  ‚Äî Main dashboard (feed, leaderboards)
  /shoutout
    /new
      page.js                ‚Äî Create new shoutout (or use modal on dashboard)
  /profile
    page.js                  ‚Äî Own profile
    /[id]
      page.js                ‚Äî Colleague public profile
  /rewards
    page.js                  ‚Äî Rewards store (stretch goal)
  layout.js                  ‚Äî Root layout with Supabase provider
  page.js                    ‚Äî Redirect to /dashboard or /login
/components
  /ui                        ‚Äî shadcn/ui components
  /shoutout
    shoutout-card.js         ‚Äî Single shoutout display card
    shoutout-feed.js         ‚Äî Scrollable feed of shoutout cards
    create-shoutout-dialog.js ‚Äî Modal dialog for creating a shoutout
  /leaderboard
    leaderboard.js           ‚Äî Reusable leaderboard component
    leaderboard-item.js      ‚Äî Single leaderboard row
  /profile
    profile-header.js        ‚Äî Avatar, name, title, department
    badge-grid.js            ‚Äî Grid of earned badges
    points-summary.js        ‚Äî Points balance + given this month
    shoutout-history.js      ‚Äî List of sent/received shoutouts
  /rewards
    reward-card.js           ‚Äî Single reward display
    rewards-grid.js          ‚Äî Grid of available rewards
  /layout
    navbar.js                ‚Äî Top navigation bar
    sidebar.js               ‚Äî Optional sidebar nav
  /auth
    auth-guard.js            ‚Äî Protected route wrapper
/lib
  /supabase
    client.js                ‚Äî Browser Supabase client
    server.js                ‚Äî Server Supabase client
    middleware.js             ‚Äî Middleware helper
  constants.js               ‚Äî Categories, point limits, etc.
  utils.js                   ‚Äî Helper functions
/middleware.js               ‚Äî Next.js middleware for auth session refresh
```

## Page Specifications

### 1. Login Page (`/login`)

- Clean, centred card layout
- App logo/name "Shoutout" with a tagline like "Celebrate your team"
- Email input field
- "Send Magic Link" button
- On submit: call `supabase.auth.signInWithOtp({ email })` with `emailRedirectTo` pointing to `/auth/callback`
- Show success state: "Check your email for a login link!"
- No password fields, no sign-up form ‚Äî magic link only
- If user is already authenticated, redirect to `/dashboard`

### 2. Auth Callback (`/auth/callback/route.js`)

- Exchange the auth code for a session
- Check if the user's profile has `full_name` set
- If profile is incomplete ‚Üí redirect to `/onboarding`
- If profile is complete ‚Üí redirect to `/dashboard`

### 3. Onboarding (`/onboarding`)

- Shown only on first login when profile is incomplete
- Form fields:
  - Full name (required)
  - Job title (required)
  - Department (required) ‚Äî select from: Engineering, Design, Marketing, Sales, Operations, HR, Finance, Support
  - Birthday (optional, date picker)
- On submit: update the `profiles` table, then redirect to `/dashboard`
- Protected route ‚Äî must be authenticated

### 4. Dashboard (`/dashboard`)

This is the main screen. Layout: two-column on desktop (feed left, leaderboards right), single column stacked on mobile.

**Left Column ‚Äî Shoutout Feed:**
- Fetch recent shoutouts from `shoutouts` table, joined with `profiles` for sender and recipient info
- Order by `created_at` DESC, limit 20
- Each shoutout card shows:
  - Sender avatar (initials-based using first letter of first and last name, coloured background) + name
  - "‚Üí" or "shouted out" text
  - Recipient avatar + name
  - Category badge (colour-coded pill, e.g. ü§ù Teamwork in a blue pill)
  - Message text
  - Points awarded (e.g. "+25 pts")
  - Relative timestamp (e.g. "2 hours ago")
- Card styling: shadcn Card with subtle left border colour matching the category

**Right Column ‚Äî Leaderboards:**
- **Team Leaderboard** ‚Äî top 5 in the user's department by points received this month
  - Query: sum of points from shoutouts received this month, filtered by department
  - Show rank, avatar, name, total points
  - Gold/silver/bronze accent for top 3
- **Company Leaderboard** ‚Äî top 5 across all departments
  - Same format, no department filter
  - Toggle: "This Month" / "All Time" tabs

**Top Bar / Quick Actions:**
- Greeting: "Hey [first_name] üëã"
- Points remaining pill: "üéØ 320 / 500 points left to give"
- Prominent "Send a Shoutout" button (opens create dialog)

**Category colour mapping (use consistently everywhere):**
```
teamwork:         blue    (bg-blue-100 text-blue-700)
innovation:       purple  (bg-purple-100 text-purple-700)
above_and_beyond: amber   (bg-amber-100 text-amber-700)
customer_focus:   green   (bg-green-100 text-green-700)
problem_solving:  cyan    (bg-cyan-100 text-cyan-700)
leadership:       rose    (bg-rose-100 text-rose-700)
```

### 5. Create Shoutout (`create-shoutout-dialog.js`)

- Trigger: "Send a Shoutout" button on dashboard opens a shadcn Dialog/Sheet
- Step-by-step or single form:
  1. **Recipient** ‚Äî Combobox/searchable select populated from `profiles` table (exclude current user)
  2. **Category** ‚Äî Grid of 6 category cards, each with emoji + label, click to select (highlight selected)
  3. **Message** ‚Äî Textarea, placeholder "What did they do that deserves recognition?", character counter showing x/280, minimum 10 chars
  4. **Points** ‚Äî Slider from 10 to 100 (step of 5), with current value displayed. Show remaining monthly balance. Slider max capped at remaining balance.
  5. **Send button** ‚Äî disabled until all fields valid

**On submit:**
- Insert into `shoutouts` table
- Update sender's `points_given_this_month` (+points)
- Update recipient's `points_balance` (+points)
- Close dialog
- Show success toast: "üéâ Shoutout sent to [name]!"
- Refresh the feed

**Validation:**
- All fields required
- Cannot select self as recipient
- Points must be between 10‚Äì100 and not exceed remaining monthly allowance
- Message 10‚Äì280 characters

### 6. Profile Page (`/profile`)

**Own profile view:**
- Large avatar (initials-based, coloured circle, 80px)
- Full name, job title, department
- Birthday and join date displayed with icons
- **Points Summary Card:**
  - Points balance (redeemable): large number with "pts" label
  - Points given this month: progress bar showing x / 500
- **Badges Section:**
  - Grid of badge cards (icon + name + awarded date)
  - Unearned badges shown greyed out / locked with a lock icon
  - Query `badges` left joined with `user_badges` for the current user
- **Shoutout History:**
  - Two tabs: "Received" and "Sent"
  - List of shoutout cards (compact version ‚Äî no avatars, just names + message + points + date)
  - Ordered by most recent

### 7. Colleague Profile (`/profile/[id]`)

- Same layout as own profile but:
  - No points balance shown
  - No "Sent" tab in history (only show received shoutouts)
  - No edit capabilities
  - Add a "Send a Shoutout" button that opens the create dialog pre-filled with this recipient
- 404 page if profile ID doesn't exist

### 8. Rewards Store (`/rewards`) ‚Äî STRETCH GOAL

- Grid of reward cards
- Each card: icon, name, description, cost in points
- "Redeem" button ‚Äî disabled if user doesn't have enough points
- On redeem: confirm dialog ‚Üí insert into `reward_redemptions` ‚Üí deduct from `points_balance` ‚Üí success toast
- Show user's current points balance at the top

## Navbar Component

- Sticky top navbar
- Left: "Shoutout" logo/text (link to /dashboard)
- Right: Points balance pill, avatar dropdown with:
  - "My Profile" ‚Üí `/profile`
  - "Rewards" ‚Üí `/rewards`
  - "Sign Out" ‚Üí call `supabase.auth.signOut()` then redirect to `/login`
- Mobile: hamburger menu

## Middleware (`/middleware.js`)

- Refresh Supabase auth session on every request
- Protect all routes except `/login` and `/auth/callback`
- Redirect unauthenticated users to `/login`
- Redirect authenticated users away from `/login` to `/dashboard`

## Constants (`/lib/constants.js`)

```javascript
export const MONTHLY_POINTS_ALLOWANCE = 500;
export const MIN_SHOUTOUT_POINTS = 10;
export const MAX_SHOUTOUT_POINTS = 100;
export const SHOUTOUT_POINTS_STEP = 5;
export const MIN_MESSAGE_LENGTH = 10;
export const MAX_MESSAGE_LENGTH = 280;

export const CATEGORIES = [
  { value: 'teamwork', label: 'Teamwork', emoji: 'ü§ù', color: 'blue' },
  { value: 'innovation', label: 'Innovation', emoji: 'üí°', color: 'purple' },
  { value: 'above_and_beyond', label: 'Going Above & Beyond', emoji: 'üî•', color: 'amber' },
  { value: 'customer_focus', label: 'Customer Focus', emoji: 'üéØ', color: 'green' },
  { value: 'problem_solving', label: 'Problem Solving', emoji: 'üß†', color: 'cyan' },
  { value: 'leadership', label: 'Leadership', emoji: 'üí™', color: 'rose' },
];

export const DEPARTMENTS = [
  'Engineering', 'Design', 'Marketing', 'Sales', 'Operations', 'HR', 'Finance', 'Support'
];
```

## Seed Data Script

Create `/scripts/seed.js` that inserts demo data directly into Supabase (run manually). Include:

- 10 demo profiles across 3 departments (Engineering, Marketing, Design) with varied join dates and birthdays
- 20 shoutouts with a mix of categories, points (10‚Äì100), and timestamps spread over the last 30 days
- Badge awards: give some users the "First Shoutout Sent" and "Team Player" badges
- All seed data should make the dashboard look alive and populated for demo purposes

## Design Guidelines

- **Colour scheme:** Clean white/slate base. Gold/amber as the primary accent colour (celebration theme). Category colours as defined above for pills and borders.
- **Typography:** Use the default shadcn/Tailwind font stack. Headings bold, body regular.
- **Spacing:** Generous padding. Cards should breathe ‚Äî don't cram content.
- **Avatars:** Generate initials-based avatars with consistent coloured backgrounds derived from the user's name (hash the name to pick from a preset palette).
- **Animations:** Subtle ‚Äî use Tailwind transitions on hover states. No heavy animation libraries.
- **Mobile:** Fully responsive. Dashboard columns stack on mobile. Navbar collapses to hamburger.
- **shadcn components to use:** Card, Button, Dialog, Input, Textarea, Select, Slider, Avatar, Badge, Tabs, Toast, DropdownMenu, Command (for searchable select), Progress

## Important Implementation Notes

1. **JavaScript only** ‚Äî do not use TypeScript. No `.ts` or `.tsx` files. All files should be `.js` or `.jsx`.
2. **App Router** ‚Äî use Next.js App Router with `app/` directory. Server components by default, add `"use client"` only where needed (interactive components, hooks).
3. **Supabase SSR** ‚Äî use `@supabase/ssr` package for server-side Supabase client. Follow the official Next.js + Supabase SSR pattern.
4. **No ORMs** ‚Äî use Supabase client directly for all queries.
5. **Error handling** ‚Äî wrap Supabase calls in try/catch, show user-friendly error toasts.
6. **Loading states** ‚Äî use shadcn Skeleton components for loading states on the dashboard and profile pages.
7. **Relative timestamps** ‚Äî use a simple helper function, no external date library needed. Format as "just now", "2 minutes ago", "3 hours ago", "2 days ago", etc.
8. **Avatar colours** ‚Äî hash the user's name to deterministically pick a background colour from a preset array of 8 colours so the same user always gets the same colour.

## Build Priority Order

Build in this order to have a working demo as fast as possible:

1. **Project setup** ‚Äî Next.js, Tailwind, shadcn, Supabase client config, middleware
2. **Auth flow** ‚Äî Login page, magic link, callback, session handling, protected routes
3. **Database** ‚Äî Run migration SQL in Supabase, seed badges and rewards
4. **Dashboard** ‚Äî Feed + leaderboards + quick actions (use mock data initially if needed)
5. **Create Shoutout** ‚Äî Dialog with full flow, database insert, feed refresh
6. **Profile page** ‚Äî Own profile with badges, points, history
7. **Colleague profiles** ‚Äî Public view at `/profile/[id]`
8. **Onboarding** ‚Äî First-login profile completion
9. **Seed data** ‚Äî Populate demo data for presentation
10. **Polish** ‚Äî Loading states, error handling, responsive tweaks, toast notifications
11. **Stretch: Rewards store** ‚Äî Browse and redeem
12. **Stretch: Discord webhook** ‚Äî Post shoutouts to a Discord channel